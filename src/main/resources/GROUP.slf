using STANDARD >>
define group = (
	define grouper as (
		:k :- :v :- list-of (:k, list-of :v) => list-of (:k, list-of :v) => list-of (:k, list-of :v)
	) = (list0 => list1 =>
		if-bind (list0 = ($k0, $v0; $t0)) then
			if-bind (list1 = ($k1, $v1; $t1)) then
				case
				|| (k0 < k1) (k0, v0; grouper {t0} {list1})
				|| (k0 > k1) (k1, v1; grouper {list0} {t1})
				|| k0, append {v0} {v1}; grouper {t0} {t1}
			else
				list0
		else
			list1
	) >>
	merge {grouper} . (`$k, $v` => (k, (v;)))
) >>
